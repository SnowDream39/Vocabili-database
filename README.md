# [术力口数据库](https://vocabili.top) 数据后端

基于 postgreSQL + SQLAlchemy + FastAPI 的数据后端

## 数据库范式设计

参见 [我的博客文章](https://blog.snowdream39.top/?p=204)。

## 历史标注修改

有时候一个 bvid 被改了 name。这个事情需要理性分析。

以前可能有UP主原地改歌的情况。这个情况我们不考虑，就以一个视频的最新状态为它的状态。（连 VocaDB 也没考虑这种情况）

所以，我们认为一个 bvid 在数据库的所有记录中始终对应一个 song。

想要修改一个视频的 name，就在新排名文件里面改就行了。

## 错误数据判断

众所周知，哈里布莱手上的数据并不是完美的。以前，很多没有打标的视频混在排名文件里面，有些甚至不是收录对象。即使是现在，也有一些空白信息混在表格中。

过去的数据文件不会再改，以后的文件必须重拳出击。我们做出如下的规定：

对于以后的文件：只有视频标题（title）字段允许为空，其他检测到空白一律打回。

对于以前的文件 title、author、vocal、synthesizer、uploader 可以为空，但是这种数据记录不会更新数据库中的 vocal、synthesizer、author、uploader。
